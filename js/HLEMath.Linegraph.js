/*! package version: 1.0.202502271658 */
!function(e){var t=window.webpackHotUpdate;window.webpackHotUpdate=function(e,n){!function(e,t){if(!x[e]||!w[e])return;for(var n in w[e]=!1,t)Object.prototype.hasOwnProperty.call(t,n)&&(p[n]=t[n]);0==--g&&0===b&&C()}(e,n),t&&t(e,n)};var n,o=!0,r="76dfaa6ac2c2ad1b2772",i={},a=[],s=[];function l(e){var t=T[e];if(!t)return A;var o=function(o){return t.hot.active?(T[o]?-1===T[o].parents.indexOf(e)&&T[o].parents.push(e):(a=[e],n=o),-1===t.children.indexOf(o)&&t.children.push(o)):a=[],A(o)},r=function(e){return{configurable:!0,enumerable:!0,get:function(){return A[e]},set:function(t){A[e]=t}}};for(var i in A)Object.prototype.hasOwnProperty.call(A,i)&&"e"!==i&&"t"!==i&&Object.defineProperty(o,i,r(i));return o.e=function(e){return"ready"===h&&f("prepare"),b++,A.e(e).then(t,(function(e){throw t(),e}));function t(){b--,"prepare"===h&&(m[e]||E(e),0===b&&0===g&&C())}},o.t=function(e,t){return 1&t&&(e=o(e)),A.t(e,-2&t)},o}function u(t){var o={_acceptedDependencies:{},_declinedDependencies:{},_selfAccepted:!1,_selfDeclined:!1,_selfInvalidated:!1,_disposeHandlers:[],_main:n!==t,active:!0,accept:function(e,t){if(void 0===e)o._selfAccepted=!0;else if("function"==typeof e)o._selfAccepted=e;else if("object"==typeof e)for(var n=0;n<e.length;n++)o._acceptedDependencies[e[n]]=t||function(){};else o._acceptedDependencies[e]=t||function(){}},decline:function(e){if(void 0===e)o._selfDeclined=!0;else if("object"==typeof e)for(var t=0;t<e.length;t++)o._declinedDependencies[e[t]]=!0;else o._declinedDependencies[e]=!0},dispose:function(e){o._disposeHandlers.push(e)},addDisposeHandler:function(e){o._disposeHandlers.push(e)},removeDisposeHandler:function(e){var t=o._disposeHandlers.indexOf(e);t>=0&&o._disposeHandlers.splice(t,1)},invalidate:function(){switch(this._selfInvalidated=!0,h){case"idle":(p={})[t]=e[t],f("ready");break;case"ready":O(t);break;case"prepare":case"check":case"dispose":case"apply":(y=y||[]).push(t)}},check:S,apply:P,status:function(e){if(!e)return h;c.push(e)},addStatusHandler:function(e){c.push(e)},removeStatusHandler:function(e){var t=c.indexOf(e);t>=0&&c.splice(t,1)},data:i[t]};return n=void 0,o}var c=[],h="idle";function f(e){h=e;for(var t=0;t<c.length;t++)c[t].call(null,e)}var d,p,v,y,g=0,b=0,m={},w={},x={};function k(e){return+e+""===e?+e:e}function S(e){if("idle"!==h)throw new Error("check() is only allowed in idle status");return o=e,f("check"),(t=1e4,t=t||1e4,new Promise((function(e,n){if("undefined"==typeof XMLHttpRequest)return n(new Error("No browser support"));try{var o=new XMLHttpRequest,i=A.p+""+r+".hot-update.json";o.open("GET",i,!0),o.timeout=t,o.send(null)}catch(e){return n(e)}o.onreadystatechange=function(){if(4===o.readyState)if(0===o.status)n(new Error("Manifest request to "+i+" timed out."));else if(404===o.status)e();else if(200!==o.status&&304!==o.status)n(new Error("Manifest request to "+i+" failed."));else{try{var t=JSON.parse(o.responseText)}catch(e){return void n(e)}e(t)}}}))).then((function(e){if(!e)return f(_()?"ready":"idle"),null;w={},m={},x=e.c,v=e.h,f("prepare");var t=new Promise((function(e,t){d={resolve:e,reject:t}}));p={};return E(0),"prepare"===h&&0===b&&0===g&&C(),t}));var t}function E(e){x[e]?(w[e]=!0,g++,function(e){var t=document.createElement("script");t.charset="utf-8",t.src=A.p+""+e+"."+r+".hot-update.js",document.head.appendChild(t)}(e)):m[e]=!0}function C(){f("ready");var e=d;if(d=null,e)if(o)Promise.resolve().then((function(){return P(o)})).then((function(t){e.resolve(t)}),(function(t){e.reject(t)}));else{var t=[];for(var n in p)Object.prototype.hasOwnProperty.call(p,n)&&t.push(k(n));e.resolve(t)}}function P(e){if("ready"!==h)throw new Error("apply() is only allowed in ready status");return j(e=e||{})}function j(t){var o,s,l,u,c;function h(e){for(var t=[e],n={},o=t.map((function(e){return{chain:[e],id:e}}));o.length>0;){var r=o.pop(),i=r.id,a=r.chain;if((u=T[i])&&(!u.hot._selfAccepted||u.hot._selfInvalidated)){if(u.hot._selfDeclined)return{type:"self-declined",chain:a,moduleId:i};if(u.hot._main)return{type:"unaccepted",chain:a,moduleId:i};for(var s=0;s<u.parents.length;s++){var l=u.parents[s],c=T[l];if(c){if(c.hot._declinedDependencies[i])return{type:"declined",chain:a.concat([l]),moduleId:i,parentId:l};-1===t.indexOf(l)&&(c.hot._acceptedDependencies[i]?(n[l]||(n[l]=[]),d(n[l],[i])):(delete n[l],t.push(l),o.push({chain:a.concat([l]),id:l})))}}}}return{type:"accepted",moduleId:e,outdatedModules:t,outdatedDependencies:n}}function d(e,t){for(var n=0;n<t.length;n++){var o=t[n];-1===e.indexOf(o)&&e.push(o)}}_();var g={},b=[],m={},w=function(){};for(var S in p)if(Object.prototype.hasOwnProperty.call(p,S)){var E;c=k(S);var C=!1,P=!1,O=!1,R="";switch((E=p[S]?h(c):{type:"disposed",moduleId:S}).chain&&(R="\nUpdate propagation: "+E.chain.join(" -> ")),E.type){case"self-declined":t.onDeclined&&t.onDeclined(E),t.ignoreDeclined||(C=new Error("Aborted because of self decline: "+E.moduleId+R));break;case"declined":t.onDeclined&&t.onDeclined(E),t.ignoreDeclined||(C=new Error("Aborted because of declined dependency: "+E.moduleId+" in "+E.parentId+R));break;case"unaccepted":t.onUnaccepted&&t.onUnaccepted(E),t.ignoreUnaccepted||(C=new Error("Aborted because "+c+" is not accepted"+R));break;case"accepted":t.onAccepted&&t.onAccepted(E),P=!0;break;case"disposed":t.onDisposed&&t.onDisposed(E),O=!0;break;default:throw new Error("Unexception type "+E.type)}if(C)return f("abort"),Promise.reject(C);if(P)for(c in m[c]=p[c],d(b,E.outdatedModules),E.outdatedDependencies)Object.prototype.hasOwnProperty.call(E.outdatedDependencies,c)&&(g[c]||(g[c]=[]),d(g[c],E.outdatedDependencies[c]));O&&(d(b,[E.moduleId]),m[c]=w)}var B,I=[];for(s=0;s<b.length;s++)c=b[s],T[c]&&T[c].hot._selfAccepted&&m[c]!==w&&!T[c].hot._selfInvalidated&&I.push({module:c,parents:T[c].parents.slice(),errorHandler:T[c].hot._selfAccepted});f("dispose"),Object.keys(x).forEach((function(e){!1===x[e]&&function(e){delete installedChunks[e]}(e)}));for(var M,D,N=b.slice();N.length>0;)if(c=N.pop(),u=T[c]){var L={},F=u.hot._disposeHandlers;for(l=0;l<F.length;l++)(o=F[l])(L);for(i[c]=L,u.hot.active=!1,delete T[c],delete g[c],l=0;l<u.children.length;l++){var H=T[u.children[l]];H&&((B=H.parents.indexOf(c))>=0&&H.parents.splice(B,1))}}for(c in g)if(Object.prototype.hasOwnProperty.call(g,c)&&(u=T[c]))for(D=g[c],l=0;l<D.length;l++)M=D[l],(B=u.children.indexOf(M))>=0&&u.children.splice(B,1);for(c in f("apply"),void 0!==v&&(r=v,v=void 0),p=void 0,m)Object.prototype.hasOwnProperty.call(m,c)&&(e[c]=m[c]);var V=null;for(c in g)if(Object.prototype.hasOwnProperty.call(g,c)&&(u=T[c])){D=g[c];var X=[];for(s=0;s<D.length;s++)if(M=D[s],o=u.hot._acceptedDependencies[M]){if(-1!==X.indexOf(o))continue;X.push(o)}for(s=0;s<X.length;s++){o=X[s];try{o(D)}catch(e){t.onErrored&&t.onErrored({type:"accept-errored",moduleId:c,dependencyId:D[s],error:e}),t.ignoreErrored||V||(V=e)}}}for(s=0;s<I.length;s++){var Y=I[s];c=Y.module,a=Y.parents,n=c;try{A(c)}catch(e){if("function"==typeof Y.errorHandler)try{Y.errorHandler(e)}catch(n){t.onErrored&&t.onErrored({type:"self-accept-error-handler-errored",moduleId:c,error:n,originalError:e}),t.ignoreErrored||V||(V=n),V||(V=e)}else t.onErrored&&t.onErrored({type:"self-accept-errored",moduleId:c,error:e}),t.ignoreErrored||V||(V=e)}}return V?(f("fail"),Promise.reject(V)):y?j(t).then((function(e){return b.forEach((function(t){e.indexOf(t)<0&&e.push(t)})),e})):(f("idle"),new Promise((function(e){e(b)})))}function _(){if(y)return p||(p={}),y.forEach(O),y=void 0,!0}function O(t){Object.prototype.hasOwnProperty.call(p,t)||(p[t]=e[t])}var T={};function A(t){if(T[t])return T[t].exports;var n=T[t]={i:t,l:!1,exports:{},hot:u(t),parents:(s=a,a=[],s),children:[]};return e[t].call(n.exports,n,n.exports,l(t)),n.l=!0,n.exports}A.m=e,A.c=T,A.d=function(e,t,n){A.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},A.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},A.t=function(e,t){if(1&t&&(e=A(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(A.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)A.d(n,o,function(t){return e[t]}.bind(null,o));return n},A.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return A.d(t,"a",t),t},A.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},A.p="",A.h=function(){return r},l(0)(A.s=0)}([function(e,t,n){"use strict";function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}n.r(t);var r=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"hexToRgba",value:function(t,n){var o=e.hexToRgb(t);return"rgba("+[o.r,o.g,o.b,n].join(",")+")"}},{key:"hexToRgb",value:function(e){var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:null}},{key:"rgbToHex",value:function(e,t,n){return((1<<24)+(e<<16)+(t<<8)+n).toString(16).slice(1)}},{key:"rgbToHsv",value:function(e,t,n){e/=255,t/=255,n/=255;var o,r,i=Math.max(e,t,n),a=Math.min(e,t,n),s=i,l=i-a;if(r=0==i?0:l/i,i==a)o=0;else{switch(i){case e:o=(t-n)/l+(t<n?6:0);break;case t:o=(n-e)/l+2;break;case n:o=(e-t)/l+4}o/=6}return[o,r,s]}},{key:"hsvToRgb",value:function(e,t,n){var o=0,r=0,i=0,a=t/100,s=n/100,l=Math.floor(e/60)%6,u=e/60-Math.floor(e/60),c=s*(1-a),h=s*(1-u*a),f=s*(1-(1-u)*a);switch(l){case 0:o=s,r=f,i=c;break;case 1:o=h,r=s,i=c;break;case 2:o=c,r=s,i=f;break;case 3:o=c,r=h,i=s;break;case 4:o=f,r=c,i=s;break;case 5:o=s,r=c,i=h}return[Math.round(255*o),Math.round(255*r),Math.round(255*i)]}}],(n=null)&&o(t.prototype,n),r&&o(t,r),e}();function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t,n){return(a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=p(e)););return e}(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function u(e,t,n){return t&&l(e.prototype,t),n&&l(e,n),e}function c(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=p(e);if(t){var r=p(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return d(this,n)}}function d(e,t){if(t&&("object"===i(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var v=function(e){c(n,e);var t=f(n);function n(e,o){var r;return s(this,n),(r=t.call(this,e,o)).className="LineFree",r}return u(n,[{key:"mousedown",value:function(e,t){a(p(n.prototype),"mousedown",this).call(this,e,t);var o=this.nowPos,r=(this.lastPos,this.shape),i=this.lineWidth,s=this.lineColor;if(this.oldMidPt=this.nowPos.clone(),null!=r){this.shape.tool=this;var l=r.graphics;l.setStrokeStyle(i,"round","round"),l.beginStroke(s),l.moveTo(o.x,o.y)}}},{key:"mousemove",value:function(e,t){if(a(p(n.prototype),"mousemove",this).call(this,e,t),null!=this.shape){var o=new createjs.Point(this.lastPos.x+this.nowPos.x>>1,this.lastPos.y+this.nowPos.y>>1);this.shape.graphics.moveTo(o.x,o.y).curveTo(this.lastPos.x,this.lastPos.y,this.oldMidPt.x,this.oldMidPt.y),this.lastPos.x=this.nowPos.x,this.lastPos.y=this.nowPos.y,this.oldMidPt.x=o.x,this.oldMidPt.y=o.y,this.shape.stage.update()}}},{key:"mouseup",value:function(e){a(p(n.prototype),"mouseup",this).call(this,e),null!=this.shape&&this.shape.graphics.endStroke()}}]),n}(function(e){c(n,createjs.EventDispatcher);var t=f(n);function n(e,o){var i;return s(this,n),(i=t.call(this)).container=e,i.shape=o,i.nowPos=new createjs.Point,i.lastPos=new createjs.Point,i.lineWidth=5,i.lineColorDefault="#FF0000",i.lineColor=r.hexToRgba(i.lineColorDefault,1),i}return u(n,[{key:"mousedown",value:function(e,t){if(null!=this.shape){var n=this.shape.globalToLocal(e,t);this.nowPos.x=n.x/1,this.nowPos.y=n.y/1,this.lastPos.x=this.nowPos.x,this.lastPos.y=this.nowPos.y,this.shape.points=[],this.shape.points.push(new createjs.Point(this.nowPos.x,this.nowPos.y)),this.pointPos=this.shape.points.length-1}}},{key:"mousemove",value:function(e,t){if(null!=this.shape){var n=this.shape.globalToLocal(e,t);this.nowPos.x=n.x/1,this.nowPos.y=n.y/1,this.shape.points.push(new createjs.Point(this.nowPos.x,this.nowPos.y))}}},{key:"mouseup",value:function(){this.calcBounds()}},{key:"calcBounds",value:function(){var e=NaN,t=NaN,n=NaN,o=NaN;(this.shape.points||[]).forEach((function(r){(isNaN(e)||e>r.x)&&(e=r.x),(isNaN(n)||n<r.x)&&(n=r.x),(isNaN(t)||t>r.y)&&(t=r.y),(isNaN(o)||o<r.y)&&(o=r.y)})),this.setBounds(e,t,n-e,o-t)}},{key:"setBounds",value:function(e,t,n,o){var r=this.shape;r&&(e=0<n?e:e+n,t=0<o?t:t+o,r.setBounds(e,t,Math.abs(n),Math.abs(o)))}}]),n}());function y(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var g=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);this.name="pen",this.container=t}var t,n,o;return t=e,(n=[{key:"init",value:function(e,t){var n=this.container;return new v(n,t)}}])&&y(t.prototype,n),o&&y(t,o),e}();function b(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return m(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return m(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var o=0,r=function(){};return{s:r,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function w(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function x(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function k(e,t,n){return t&&x(e.prototype,t),n&&x(e,n),e}var S=function(){function e(t,n){w(this,e),this.container=t,this.shapeContainer=n,this.nowPos=new createjs.Point,this.lastPos=new createjs.Point,this.needRemoveObjs=null,this.lineColor=""}return k(e,[{key:"init",value:function(e){return this.shape=e||this.shape,this}},{key:"mousedown",value:function(e,t){this.shapeContainer&&(this.shape=this.shapeContainer.addChild(new createjs.Shape)),null!=this.shape&&(this.nowPos=this.shape.globalToLocal(e,t),this.lastPos.x=this.nowPos.x,this.lastPos.y=this.nowPos.y)}},{key:"mousemove",value:function(e,t){if(null!=this.shape){this.nowPos=this.shape.globalToLocal(e,t);var n=this.lastPos,o=this.nowPos,r=o.x-n.x,i=o.y-n.y,a=this.shape.graphics;a.clear(),a.setStrokeStyle(1,"round","round"),a.beginStroke(createjs.Graphics.getRGB("0x00FF00",1)),a.beginFill(createjs.Graphics.getRGB("0xFFFFFF",.5)),a.drawRect(n.x,n.y,r,i),a.endFill()}}},{key:"mouseup",value:function(){if(null!=this.shape){var e=this.nowPos.x<this.lastPos.x?this.nowPos.x:this.lastPos.x,t=this.nowPos.y<this.lastPos.y?this.nowPos.y:this.lastPos.y,n=Math.abs(this.nowPos.x-this.lastPos.x),o=Math.abs(this.nowPos.y-this.lastPos.y);this.shape.parent.removeChild(this.shape),this.shape=null;for(var r=new createjs.Rectangle(e,t,n,o),i=this.getRectObjects(r),a=0,s=i.length;a<s;a++)i[a].parent.removeChild(i[a])}}},{key:"getRectObjects",value:function(e){for(var t=this.shapeContainer.children,n=t.length,o=[],r=(e.x,e.width,e.y,e.height,0);r<n;r++)t[r].points&&this._isPointInRect(t[r].points,e)&&o.unshift(t[r]);return o}},{key:"_isPointInRect",value:function(e,t){var n,o=b(e);try{for(o.s();!(n=o.n()).done;){var r=n.value;if(t.x<r.x&&r.x<t.x+t.width&&t.y<r.y&&r.y<t.y+t.height)return!0}}catch(e){o.e(e)}finally{o.f()}return!1}}]),e}(),E="mouse",C="LineFree",P="RectEraser";function j(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function _(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var O=["#F20000","#FF7F27","#FFFF01","#22B14C","#00A2E8","#A349A4"];var T=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,o;return t=e,o=[{key:"getHtmlParams",value:function(e){var t=new Object;if(-1!=e.indexOf("?"))for(var n=decodeURI(e.substr(1)).split("&"),o=0;o<n.length;o++)t[n[o].split("=")[0]]=unescape(n[o].split("=")[1]);return t}},{key:"cloneItem",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;try{var o=e.an.getComposition(e.anid).getLibrary(),r=new o[t];if(r.gotoAndStop(0),null!=n)for(var i in n)r[i]=n[i];return r}catch(e){}return null}}],(n=null)&&j(t.prototype,n),o&&j(t,o),e}();function A(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function R(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}_(T,"isDemo",!0),_(T,"sceneHistory",[]),_(T,"htmlParams",{}),_(T,"drawBoard",null),_(T,"penColorIndex",0),_(T,"appMain",null),_(T,"exportRoot",null),_(T,"anid",null),_(T,"cjs",null),_(T,"an",null),_(T,"theme",1),_(T,"type",0),_(T,"lineStyleNum",1),_(T,"lineLengthPosNum",1);var B=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.container=t,n&&n.gotoAndStop(0),this.cursor=n,this.states=[e.DEFAULT],this.enbale=!1}var t,n,o;return t=e,(n=[{key:"moveTo",value:function(e,t){var n=this.cursor;if(null!=n){n.x=e,n.y=t;var o=n.parent;o.getChildIndex(n)!=o.children.length-1&&o.setChildIndex(n,o.children.length-1)}}},{key:"reset",value:function(){this.states.length>1&&this.states.shift(),this.setCursor(this.states[0])}},{key:"setEnable",value:function(t){this.enbale!=t&&(this.enbale=t,null!=this.cursor&&(this.cursor.visible=this.states[0]<e.DEFAULT&&t))}},{key:"setType",value:function(t){this._pushState(t),t<e.DEFAULT&&null!=this.cursor&&this.cursor.gotoAndStop(t)}},{key:"_pushState",value:function(e){this.states[0]!=e&&this.states.unshift(e)}}])&&A(t.prototype,n),o&&A(t,o),e}();function I(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}R(B,"DEFAULT",100),R(B,"ARROW",101),R(B,"PEN",0),R(B,"ERASER",1);var M=function(){function e(t,n,o,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.cjs=t,this.an=n,this.exportRoot=o,this.id=r,o&&o.gotoAndStop(0),this.handleEvtBind=this.handleEvt.bind(this),this._mouseEnabled=!1,Object.defineProperty(this,"mouseEnabled",{get:function(){return this._mouseEnabled},set:function(e){this._mouseEnabled=e,this.container.mouseChildren=e,this.container.mouseEnabled=e,this.drawStage&&this.drawStage!=this.exportRoot.stage&&(this.drawStage.canvas.style.pointerEvents=e?"auto":"none")}}),Object.defineProperty(this,"logEnabled",{get:function(){return this.drawStage&&this.drawStage.text},set:function(e){this.drawStage&&this.logSetup(e)}})}var t,n,o;return t=e,(n=[{key:"clearAll",value:function(){this._recycle()}},{key:"selectTool",value:function(e){this._seletTool(e)}},{key:"setLineColor",value:function(e){this.lineColor=r.hexToRgba(e,1)}},{key:"init",value:function(e){var t=e.canvasName;this.drawWidth=e.drawWidth||1280,this.drawHeight=e.drawHeight||720,this.cursor=new B(this,e.cursor||null),this.isDown=!1,this.isMove=!1,this.nowX=0,this.nowY=0,this.lastFrameRate=null,this.drawStage=t?this.initCanvas(t,this.exportRoot.stage):this.exportRoot.stage,this.stageSetup(this.drawStage,this.handleEvtBind),this.logEnabled&&this.logSetup(!0);var n=this.exportRoot||this.drawStage.addChild(new createjs.Container);this.container=n,this.hitAreaMC=n.addChild(this._createBackground(this.drawWidth,this.drawHeight,"rgba(255,255,255,0.01)")),this.hitAreaMC.addEventListener("mousedown",(function(e){})),this.hitAreaMC.cursor="none",this.shapeContainer=n.addChild(new createjs.Container),this.shapeContainer.mouseEnabled=!1,this.shapeContainer.mouseChildren=!1,this.shapeContainer.mask=this._createBackground(this.drawWidth,this.drawHeight,"rgba(255,255,255,1)"),this.shapeID=0,this.curShape=null,this.curTool=null,this.setLineColor("#FF0000"),this.selectTool()}},{key:"initCanvas",value:function(e,t){var n=e||"drawCanvas",o=document.createElement("canvas");o.setAttribute("id",n),o.setAttribute("width",canvas.getAttribute("width")),o.setAttribute("height",canvas.getAttribute("width")),o.setAttribute("style",canvas.getAttribute("style")),o.style.backgroundColor="rgba(255,255,255,0)",this.insertAfter(o,canvas);var r=new createjs.Stage(n);function i(){o.width=canvas.width,o.height=canvas.height,o.style.width=canvas.style.width,o.style.height=canvas.style.height,r.scaleX=t.scaleX,r.scaleY=t.scaleY,r.tickOnUpdate=!1,r.update(),r.tickOnUpdate=!0}return r.enableMouseOver(),r.nextStage=t,createjs.Ticker.addEventListener("tick",r),window.addEventListener("resize",i),i(),r}},{key:"insertAfter",value:function(e,t){var n=t.parentNode;return n.lastChild==t?n.appendChild(e):n.insertBefore(e,t.nextSibling)}},{key:"stageSetup",value:function(e,t){return e.addEventListener("stagemousedown",t),e.addEventListener("stagemouseup",t),e.addEventListener("stagemousemove",t),e.addEventListener("mouseleave",t),e.addEventListener("mouseenter",t),e}},{key:"logSetup",value:function(e){var t=this.drawStage;t&&(t.log=[],t.text=t.addChild(new createjs.Text("","15px monospace","#111")).set({x:30,y:30,lineHeight:16.7}),t.text.visible=e)}},{key:"handleEvt",value:function(e){if(this.mouseEnabled&&e.primary){var t=this.drawStage;if(this.logEnabled){e.target;var n=(t=this.drawStage).log;for(n.push(e.type+" x:"+e.stageX.toFixed(0)+" y:"+e.stageY.toFixed(0));n.length>12;)n.shift();t.text.text=n.join("\n")}switch(e.type){case"mouseenter":case"mouseover":case"mouseout":break;case"stagemousedown":this.handleMouseDown(t.mouseX,t.mouseY);break;case"stagemouseup":this.handleMouseUp(t.mouseX,t.mouseY);break;case"stagemousemove":this.handleMouseMove(t.mouseX,t.mouseY)}}}},{key:"handleMouseDown",value:function(e,t){if(this.curTool){var n=this.drawStage,o=e/n.scaleX,r=t/n.scaleY;if(0==this.isDown&&this.hitAreaMC.hitTest(o,r)){this.isDown=!0,this.nowX=e,this.nowY=t;var i=this.curTool,a=this.curShape,s=this.shapeContainer;i.className==C&&(null==a&&((a=s.addChild(new createjs.Shape)).name="shape_"+ ++this.shapeID,a.x=0,a.y=0,this.curShape=a),i.shape=a,i.lineColor=this.lineColor,this.lastFrameRate=createjs.Ticker.frameRate),i&&i.mousedown(e,t),this.cursor.setEnable(!0),this.cursor.moveTo(o,r),0==createjs.Ticker.frameRate&&n.update()}}}},{key:"handleMouseUp",value:function(e,t){if(this.curTool&&1==this.isDown){var n=this.curTool;n&&n.mouseup(),this.curShape=null,this.isMove=!1,this.isDown=!1,this.cursor.cursor.stage&&1==createjs.Touch.isSupported()&&this.cursor.setEnable(!1),null!=this.lastFrameRate&&(createjs.Ticker.frameRate=this.lastFrameRate,this.lastFrameRate=null)}}},{key:"handleMouseMove",value:function(e,t){if(this.curTool){var n=this.drawStage,o=e/n.scaleX,r=t/n.scaleY;if(1==this.hitAreaMC.hitTest(o,r)){if(this.cursor.moveTo(o,r),1==this.isDown&&(Math.abs(e-this.nowX)>1||Math.abs(t-this.nowY.y)>1)){var i=this.curTool;i&&i.mousemove(e,t),this.isMove=!0,this.nowX=e,this.nowY=t}}else this.cursor.moveTo(o,-1e3);0==createjs.Ticker.frameRate&&n.update()}}},{key:"_createBackground",value:function(e,t,n){var o=new createjs.Shape;return o.graphics.beginFill(n||"rgba(255,255,255,0.01)"),o.graphics.drawRect(0,0,e,t),o.graphics.endFill(),o}},{key:"_recycle",value:function(){this.curTool&&this.curTool.shape&&(this.curTool.shape=null),this.curShape=null,this.shapeContainer&&this.shapeContainer.removeAllChildren()}},{key:"_seletTool",value:function(e){switch(e){case C:this.curTool=new g(this,this.curShape).init(),this.cursor.setType(B.PEN),this.cursor.setEnable(!0),this.hitAreaMC.visible=!0,this.mouseEnabled=!0;break;case P:this.curTool=new S(this,this.shapeContainer).init(),this.cursor.setType(B.ERASER),this.cursor.setEnable(!0),this.hitAreaMC.visible=!0,this.mouseEnabled=!0;break;default:this.curTool=null,this.cursor.setType(B.ARROW),this.cursor.setEnable(!1),this.hitAreaMC.visible=!1,this.mouseEnabled=!1}}}])&&I(t.prototype,n),o&&I(t,o),e}(),D=["#F20000","#FF7F27","#FFFF01","#22B14C","#00A2E8","#A349A4"],N=D;function L(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return F(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return F(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var o=0,r=function(){};return{s:r,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function F(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function H(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var V=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.handle=t,this.exportRoot=n,n&&(n.gotoAndStop(0),this.init()),Object.defineProperty(this,"visible",{get:function(){return this.exportRoot&&this.exportRoot.visible},set:function(e){this.exportRoot.visible=e}}),this._selectedIndex=0,Object.defineProperty(this,"selectedIndex",{get:function(){return this._selectedIndex},set:function(e){this._selectedIndex=e,this._updateFocus()}}),this.onSelectedEvent=[]}var t,n,o;return t=e,(n=[{key:"init",value:function(){var e=this;this.colorObjs=[];var t,n=this.exportRoot,o=0,r=L(n.children);try{for(r.s();!(t=r.n()).done;){t.value;var i=n.getChildByName("btn_"+ ++o);if(!i)break;i instanceof createjs.MovieClip&&(i.gotoAndStop(0),i.cursor="pointer",i.mouseChildren=!1),i.addEventListener("mousedown",(function(t){e.onClickBtn(t)})),this.colorObjs.push(i)}}catch(e){r.e(e)}finally{r.f()}this.exportRoot.getChildAt(0).addEventListener("mousedown",(function(e){})),this.focus=this.exportRoot.getChildByName("focus"),this._initColors(),this.hide(),this._checkHideBind=this._checkHide.bind(this)}},{key:"onClickBtn",value:function(e){var t=e.currentTarget,n=t&&t.name?t.name.split("_"):null;if(n){this.selectedIndex=parseInt(n[1],10)-1,this._updateFocus();var o,r=L(this.onSelectedEvent);try{for(r.s();!(o=r.n()).done;){var i=o.value;null!=i&&i(e)}}catch(e){r.e(e)}finally{r.f()}}}},{key:"show",value:function(){this.exportRoot.visible=!0,this.exportRoot.parent.setChildIndex(this.exportRoot,this.exportRoot.parent.children.length-1),this.exportRoot.stage.addEventListener("stagemousedown",this._checkHideBind,!0)}},{key:"hide",value:function(){this.exportRoot.visible=!1,this.exportRoot.stage.removeEventListener("stagemousedown",this._checkHideBind,!0),this.stopEvent&&(this.stopEvent.removeEventListener("mousedown",this._checkHideBind),this.stopEvent.parent.removeChild(this.stopEvent),this.stopEvent=null)}},{key:"_initColors",value:function(){for(var e=this.colorObjs,t=0,n=e.length;t<n;t++){var o=e[t],i=r.hexToRgb(N[t]);o.filters=[new createjs.ColorFilter(i.r/255,i.g/255,i.b/255,1)],o.nominalBounds&&o.cache(o.nominalBounds.x,o.nominalBounds.y,o.nominalBounds.width,o.nominalBounds.height)}}},{key:"_checkHide",value:function(e){this.exportRoot.visible&&0==this.exportRoot.hitTest(e.stageX,e.stageY)&&(this.hide(),T.drawBoard.mouseEnabled=!0)}},{key:"_updateFocus",value:function(){this.focus.x=this.colorObjs[this.selectedIndex].x}}])&&H(t.prototype,n),o&&H(t,o),e}();function X(e){return(X="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Y(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function U(e,t){return(U=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function K(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=Z(e);if(t){var r=Z(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return W(this,n)}}function W(e,t){if(t&&("object"===X(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return $(e)}function $(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Z(e){return(Z=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var G=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&U(e,t)}(i,createjs.Container);var t,n,o,r=K(i);function i(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(n=r.call(this)).handle=e,n.cjs=n.handle.cjs,n.an=n.handle.an,n.exportRoot=t,n.anid=n.handle.anid||n.handle.id,n.onAddedToStageBind=n.onAddedToStage.bind($(n)),t&&(0==t.paused&&t.gotoAndStop(0),t&&null==t.stage?t.addEventListener("added",n.onAddedToStageBind):n.onAddedToStage(null)),n}return t=i,(n=[{key:"onAddedToStage",value:function(e){this.init()}},{key:"destroy",value:function(){var e=this.exportRoot;e&&e.hasEventListener("added")&&e.removeEventListener("added",this.onAddedToStageBind),this.removeAllEventListeners(),this.removeAllChildren()}},{key:"init",value:function(){}},{key:"initBtnMC",value:function(e,t,n,o,r){return e instanceof this.cjs.MovieClip&&(e.cursor="pointer",e.gotoAndStop(0),e.mouseChildren=!1,e.buttonHelper=e.buttonHelper||new this.cjs.ButtonHelper(e,t,n,o,r)),e}},{key:"notNull",value:function(e){return null!=e}},{key:"setColorFilter",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0,u=arguments.length>9&&void 0!==arguments[9]?arguments[9]:0;this.notNull(e)&&e instanceof createjs.MovieClip&&(t?(e.filters=[new createjs.ColorFilter(n,o,r,i,a,s,l,u)],this.notNull(e.nominalBounds)&&e.cache(e.nominalBounds.x,e.nominalBounds.y,e.nominalBounds.width,e.nominalBounds.height)):(e.filters=[],e.uncache()))}},{key:"setColorGrayFilter",value:function(e,t){this.notNull(e)&&e instanceof createjs.MovieClip&&(e.mouseEnabled=!t,e.mouseChildren=!t,t?(e.filters=[new createjs.ColorFilter(1,1,1,1,-100,-100,-100,0)],this.notNull(e.nominalBounds)&&e.cache(e.nominalBounds.x,e.nominalBounds.y,e.nominalBounds.width,e.nominalBounds.height)):(e.filters=[],e.uncache()))}},{key:"setDisableBtnMc",value:function(e,t,n){e instanceof this.cjs.MovieClip&&e.gotoAndStop(n),e.buttonHelper&&(e.buttonHelper._isPressed=t,e.buttonHelper.enabled=!t)}},{key:"setVisible",value:function(e){this.exportRoot&&this.exportRoot.visible!=e&&(this.exportRoot.visible=e)}},{key:"start",value:function(){}},{key:"stop",value:function(){}}])&&Y(t.prototype,n),o&&Y(t,o),i}();function q(e){return(q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function z(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function J(e,t){return(J=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Q(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=te(e);if(t){var r=te(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return ee(this,n)}}function ee(e,t){if(t&&("object"===q(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function te(e){return(te=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ne=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&J(e,t)}(i,e);var t,n,o,r=Q(i);function i(e,t){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),r.call(this,e,t)}return t=i,(n=[{key:"hide",value:function(){this.setVisible(!1)}},{key:"show",value:function(){this.setVisible(!0)}}])&&z(t.prototype,n),o&&z(t,o),i}(G);function oe(e){return(oe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function re(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return ie(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ie(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var o=0,r=function(){};return{s:r,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function ie(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function ae(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function se(e,t){return(se=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function le(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=ce(e);if(t){var r=ce(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return ue(this,n)}}function ue(e,t){if(t&&("object"===oe(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function ce(e){return(ce=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function he(e){return(he="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function fe(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return de(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return de(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var o=0,r=function(){};return{s:r,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function de(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function pe(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function ve(e,t){return(ve=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ye(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=be(e);if(t){var r=be(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return ge(this,n)}}function ge(e,t){if(t&&("object"===he(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function be(e){return(be=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var me={BACKSPACE:"backspace",INPUT:"input",ADD:"add",PLUS:"plus"},we="mousedown",xe=null;function ke(e){return(ke="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Se(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function Ee(e,t,n){return(Ee="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_e(e)););return e}(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function Ce(e,t){return(Ce=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Pe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=_e(e);if(t){var r=_e(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return je(this,n)}}function je(e,t){if(t&&("object"===ke(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function _e(e){return(_e=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Oe="input",Te=null,Ae=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ce(e,t)}(i,e);var t,n,o,r=Pe(i);function i(e,t){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),r.call(this,e,t)}return t=i,(n=[{key:"hide",value:function(){this.exportRoot.stage.removeEventListener("stagemousedown",this.onMouseDownCheckHideBind),Te=null,Ee(_e(i.prototype),"hide",this).call(this)}},{key:"onMouseDownCheckHide",value:function(e){var t=this.exportRoot,n=t.globalToLocal(e.stageX,e.stageY);if(null==t||1!=t.hitTest(n.x,n.y)){var o=Te;null!=o&&!(o instanceof createjs.MovieClip)&&(o=o.exportRoot),null!=o&&(n=o.globalToLocal(e.stageX,e.stageY),1==o.hitTest(n.x,n.y))||this._clickOK()}}},{key:"show",value:function(){Ee(_e(i.prototype),"show",this).call(this),this.exportRoot.stage.addEventListener("stagemousedown",this.onMouseDownCheckHideBind)}},{key:"init",value:function(){this.isInited||(this.isInited=!0,this.dragInit(),this.inputInit(),this.onMouseDownCheckHideBind=this.onMouseDownCheckHide.bind(this))}},{key:"inputInit",value:function(){Ee(_e(i.prototype),"inputInit",this).call(this),this.maxChars=0,this.maxValue=null,this.minValue=null,this.restricts=null}},{key:"reset",value:function(){Ee(_e(i.prototype),"reset",this).call(this)}},{key:"setOK",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];e?this._clickOK():this.clear()}},{key:"getValue",value:function(){return this.text}},{key:"setValue",value:function(e){e=e||"",0<this.maxChars&&(e=e.toString().substring(0,this.maxChars)),this.text=e,this.operations.length=0;for(var t=0;t<this.text.length;t++)this.operations.push({OPERATES:Oe,value:this.text.charAt(t)})}},{key:"getTarget",value:function(){return Te}},{key:"setTarget",value:function(e){null!=(Te=e)&&(this.maxChars=null,this.maxValue=null,this.minValue=null,this.restricts=null,void 0!==Te.maxChars&&0<Te.maxChars&&(this.maxChars=Te.maxChars),void 0!==Te.maxValue&&0<Te.maxValue&&(this.maxValue=Te.maxValue),void 0!==Te.minValue&&0<=Te.minValue&&(this.minValue=Te.minValue),void 0!==Te.restricts&&0<Te.restricts.length&&(this.restricts=Te.restricts),this.setValue(null!=Te.getValue?Te.getValue():null))}},{key:"checkValue",value:function(){var e=parseInt(this.text);return isNaN(e)?null:!(e>this.maxValue||e<this.minValue)}},{key:"_checkValue",value:function(e,t,n){var o=parseInt(e);return isNaN(o)||(null!=t&&o<t&&(o=t),null!=n&&o>n&&(o=n),String(o)!=e&&(e=String(o))),e}},{key:"_clickOK",value:function(){null!=Te&&null!=Te.setValue&&Te.setValue(this.text),Ee(_e(i.prototype),"_clickOK",this).call(this)}},{key:"_update",value:function(){0<this.maxChars&&this.maxChars<this.operations.length&&(this.operations=this.operations.slice(0,this.maxChars));var e=this.operations,t=[];e.forEach((function(e){e.OPERATES==Oe&&t.push(e.value)}));var n=t.join("");this.text!=n&&(this.text=n,null!=Te&&null!=Te.setValue&&Te.setValue(this.text),this.onEventChange.forEach((function(e){null!=e&&e()})))}}])&&Se(t.prototype,n),o&&Se(t,o),i}(function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ve(e,t)}(i,e);var t,n,o,r=ye(i);function i(e,t){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),r.call(this,e,t)}return t=i,(n=[{key:"clear",value:function(){this.operations.length=0,this.text=null}},{key:"init",value:function(){this.isInited||(this.isInited=!0,this.dragInit(),this.inputInit())}},{key:"inputInit",value:function(){this._operates=me,this._clickEvent=we,this.onEventChange=[],this.onEventOK=[],this.operations=[],this._initBtns(),this.orgX=this.exportRoot.x,this.orgY=this.exportRoot.y,Object.defineProperty(this,"target",{get:function(){return xe},set:function(e){null!=(xe=e)&&this.setValue(null!=xe.getValue?xe.getValue():null)}})}},{key:"hide",value:function(){this.target=null,this.operations.length=0,this.setVisible(!1)}},{key:"reset",value:function(){this.hide(),this.exportRoot.x=this.orgX,this.exportRoot.y=this.orgY}},{key:"setValue",value:function(e){this.text=e||"",this.operations.length=0;for(var t=0;t<this.text.length;t++)this.operations.push({OPERATES:me.INPUT,value:this.text.charAt(t)})}},{key:"_initBtns",value:function(){var e,t=this,n=this.exportRoot;n.mouseChildren=!0;var o,r=fe(n.children);try{for(r.s();!(o=r.n()).done;)(e=o.value)instanceof createjs.MovieClip&&e.gotoAndStop(0),null!=e.name&&function(){var n=e.name.split("_");"btn"==n[0]&&(e.cursor="pointer",e.mouseChildren=!1,e.buttonHelper=new createjs.ButtonHelper(e,0,0,1,!1),"ok"==n[1]?e.addEventListener(we,(function(e){t._clickOK()})):"backspace"==n[1]?e.addEventListener(we,(function(e){t.operations.pop(),t._update()})):"clear"==n[1]?e.addEventListener(we,(function(e){t.clear(),t._update()})):"0"!=n[1]&&"1"!=n[1]&&"2"!=n[1]&&"3"!=n[1]&&"4"!=n[1]&&"5"!=n[1]&&"6"!=n[1]&&"7"!=n[1]&&"8"!=n[1]&&"9"!=n[1]||(e.value=n[1],e.addEventListener(we,(function(e){t.operations.push({OPERATES:me.INPUT,value:n[1]}),t._update()}))))}()}catch(e){r.e(e)}finally{r.f()}}},{key:"_clickOK",value:function(){this.onEventOK.forEach((function(e){null!=e&&e()}))}},{key:"_update",value:function(){var e=this.operations,t=[];e.forEach((function(e){e.OPERATES==me.INPUT&&t.push(e.value)}));var n=t.join("");this.text!=n&&(this.text=n,null!=xe&&null!=xe.setValue&&xe.setValue(this.text),this.onEventChange.forEach((function(e){null!=e&&e()})))}}])&&pe(t.prototype,n),o&&pe(t,o),i}(function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&se(e,t)}(i,e);var t,n,o,r=le(i);function i(e,t){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),r.call(this,e,t)}return t=i,(n=[{key:"init",value:function(){this.isInited||(this.isInited=!0,this.dragInit())}},{key:"dragInit",value:function(){this.dragAlpha=null,this.orgAlpha=1,this.dragEnable=!0,this.downPos={x:0,y:0},this.dragTarget=null,this.dragItem=null,this.hasDragHandle=!1,this.onDragStartBind=this.onDragStart.bind(this),this.onDragEndBind=this.onDragEnd.bind(this),this.onDragBind=this.onDrag.bind(this),this.onDragStartEvent=[],this.onDragEndEvent=[],this.onDragEvent=[]}},{key:"setDragTarget",value:function(e){this.dragTarget&&this.dragTarget.removeEventListener("mousedown",this.onDragStartBind),this.dragTarget=e,this.hasDragHandle=null!=this.dragTarget&&this.dragTarget!==this,null!=this.dragTarget&&this.dragTarget.addEventListener("mousedown",this.onDragStartBind)}},{key:"setItemDrag",value:function(e,t){if(null!=e){e.stage.addEventListener("pressup",this.onDragEndBind),e.stage.addEventListener("pressmove",this.onDragBind);var n=e.parent.globalToLocal(t.stageX,t.stageY);e.offsetX=e.x-n.x,e.offsetY=e.y-n.y}}},{key:"onDragStart",value:function(e){if(this.dragEnable){this.downPos.x=e.stageX.toFixed(0),this.downPos.y=e.stageY.toFixed(0);var t=this.hasDragHandle?this.dragTarget.parent:e.currentTarget;this.setItemDrag(t,e),this.dragItem=t,t.parent.setChildIndex(t,t.parent.children.length-1);var n,o=re(this.onDragStartEvent);try{for(o.s();!(n=o.n()).done;){var r=n.value;null!=r&&r(e)}}catch(e){o.e(e)}finally{o.f()}e.stopPropagation(),e.stopImmediatePropagation()}}},{key:"onDragEnd",value:function(e){if(this.dragEnable){var t=this.dragItem;t&&(t.stage.removeEventListener("pressup",this.onDragEndBind),t.stage.removeEventListener("pressmove",this.onDragBind)),null!=this.dragAlpha&&(t.alpha=this.orgAlpha||1);var n,o=re(this.onDragEndEvent);try{for(o.s();!(n=o.n()).done;){var r=n.value;null!=r&&r(e)}}catch(e){o.e(e)}finally{o.f()}}}},{key:"onDrag",value:function(e){if(this.dragEnable){var t=e.stageX.toFixed(0)-this.downPos.x,n=e.stageY.toFixed(0)-this.downPos.y;if(!(Math.abs(t)<1&&Math.abs(n)<1)){var o=this.dragItem,r=o.parent.globalToLocal(e.stageX,e.stageY);o.x=r.x+o.offsetX,o.y=r.y+o.offsetY,null!=this.dragAlpha&&o.alpha!=this.dragAlpha&&(this.orgAlpha=o.alpha,o.alpha=this.dragAlpha);var i,a=re(this.onDragEvent);try{for(a.s();!(i=a.n()).done;){var s=i.value;null!=s&&s(e)}}catch(e){a.e(e)}finally{a.f()}e.stopPropagation(),e.stopImmediatePropagation()}}}}])&&ae(t.prototype,n),o&&ae(t,o),i}(ne)));function Re(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Be(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Be(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var o=0,r=function(){};return{s:r,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function Be(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function Ie(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var Me=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.handle=t,this.exportRoot=n,n&&(n.gotoAndStop(0),this.init())}var t,n,o;return t=e,(n=[{key:"init",value:function(){var e=this,t=this.exportRoot;this.stage=t.stage;var n,o=Re(t.children);try{for(o.s();!(n=o.n()).done;){var r=n.value;r.name&&function(){var t=r.name.split("_");"btn"==t[0]&&(r instanceof createjs.MovieClip&&(r.gotoAndStop(0),r.cursor="pointer",r.mouseChildren=!1),r.addEventListener("mousedown",(function(n){e.selectToolBtn(t[1])})))}()}}catch(e){o.e(e)}finally{o.f()}this.toolMask=t.getChildByName("tool_mask")||new createjs.MovieClip,null!=this.toolMask&&(this.toolMask.gotoAndStop(0),this.toolMask.mouseChildren=!1,this.toolMask.tickChildren=!1),null!=this.toolMask&&this.toolMask.addEventListener("mousedown",(function(e){})),this.stage.addEventListener("change_mask",(function(t){var n=t.data;null!=n&&!0===n.canShowFraction?e.showfractionMask.visible=!1:e.showfractionMask.visible=!0})),this.curSelected=null,this.selectToolBtn("mouse"),this.helpBtn=this.exportRoot.getChildByName("btn_help"),this.helpBtn&&this.helpBtn instanceof createjs.MovieClip&&(this.helpBtn.gotoAndStop(0),this.helpBtn.mouseChildren=!1,this.helpBtn.cursor="pointer"),this.helpBtn&&this.helpBtn.addEventListener("mousedown",(function(t){null!=e.intro&&(e.handle.drawBoard.cursor.setType(B.DEFAULT),e.handle.drawBoard.exportRoot.mouseChildren=!1,e.handle.drawBoard.mouseEnabled=!1,e.intro.visible=!0,e.intro.parent.setChildIndex(e.intro,e.intro.parent.numChildren-1))}));var i=this.exportRoot.getChildByName("intro");if(null!=i){i.gotoAndStop(0),i.visible=!1,i.getChildAt(0).addEventListener("mousedown",(function(e){}));var a=i.getChildByName("btn_close");null!=a&&a.addEventListener("mousedown",(function(t){i.visible=!1;var n=e.handle.drawBoard.cursor.states;n.shift();var o=n.shift();e.handle.drawBoard.cursor.setType(o),e.handle.drawBoard.exportRoot.mouseChildren=!0,o!=B.DEFAULT&&(e.handle.drawBoard.mouseEnabled=!0)}))}this.intro=i}},{key:"reset",value:function(){var e=this.handle.drawBoard;e&&(e.selectTool(E),e.clearAll()),null!=this.handle.reset&&this.handle.reset(),this.selectToolBtn("mouse")}},{key:"selectToolBtn",value:function(e){var t=this.handle.drawBoard,n=this.exportRoot.getChildByName("btn_"+e);if(null==this.curSelected||this.curSelected!=n){var o=!1;switch(e){case"help":break;case"home":T.type=0,this.handle.setSceneById(0),this.selectToolBtn("reset");break;case"reset":this.reset();break;case"select":this.handle.setTypePanelShow(!0);break;case"mouse":this.toolMask&&1==this.toolMask.visible&&(this.toolMask.visible=!1),o=!0,t&&t.selectTool(E);break;case"pen":this.toolMask&&0==this.toolMask.visible&&(this.toolMask.visible=!0),o=!0,this.handle.setPenColorPanelShow(!0),t&&t.selectTool(C);break;case"eraser":this.toolMask&&0==this.toolMask.visible&&(this.toolMask.visible=!0),o=!0,t&&t.selectTool(P);break;case"eraserall":t&&t.clearAll()}1==o&&n&&(n instanceof createjs.MovieClip&&1<n.totalFrames&&n.gotoAndStop(1),this._unselect(),this.curSelected=n)}else"pen"==e&&this.handle.setPenColorPanelShow(!0)}},{key:"_unselect",value:function(){null!=this.curSelected&&1<this.curSelected.totalFrames&&(this.curSelected.gotoAndStop(0),this.curSelected=null)}}])&&Ie(t.prototype,n),o&&Ie(t,o),e}();function De(e){return(De="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ne(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Le(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Le(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var o=0,r=function(){};return{s:r,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function Le(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function Fe(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function He(e,t){return(He=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ve(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=Ue(e);if(t){var r=Ue(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return Xe(this,n)}}function Xe(e,t){if(t&&("object"===De(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Ye(e)}function Ye(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ue(e){return(Ue=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Ke=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&He(e,t)}(i,e);var t,n,o,r=Ve(i);function i(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(n=r.call(this,e,t)).selectedEvents=[],n.isCanMove=!1,n.isKeepSelected=!1,n._target=null,Object.defineProperty(Ye(n),"target",{get:function(){return this._target},set:function(e){this._target=e,1==this.isCanMove&&this._updatePosition()}}),n._value=null,Object.defineProperty(Ye(n),"value",{get:function(){return this._value},set:function(e){var t=this;this._value=e,!0===this.isKeepSelected&&null!=this.numBtns&&this.numBtns.forEach((function(n){var o=n.value==e,r=o?2:0;t.setDisableBtnMc(n,o,r)}))}}),n}return t=i,(n=[{key:"init",value:function(){var e=this,t=this.exportRoot;t.mouseChildren=!0,this.numBtns=[];var n,o=Ne(t.children);try{for(o.s();!(n=o.n()).done;){var r=n.value;if(r&&r.name)if("btn_ok"==r.name)this.initBtnMC(r,0,0,1,!1),r.value=nameArr[1],r.addEventListener("click",(function(){e.clickBtnNum(evt.currentTarget.value)})),this.btnOK=r;else{var i=r.name.split("_");"btn"==i[0]&&(this.initBtnMC(r,0,0,1,!1),r.value=parseInt(i[1]),r.addEventListener("click",(function(t){e.clickBtnNum(t.currentTarget.value)})),this.numBtns.push(r))}}}catch(e){o.e(e)}finally{o.f()}this.exportRoot.getChildAt(0).addEventListener("mousedown",(function(e){})),this._checkHideBind=this._checkHide.bind(this)}},{key:"hide",value:function(){this.exportRoot.visible=!1,this.exportRoot.stage.removeEventListener("stagemousedown",this._checkHideBind,!0),this.stopEvent&&(this.stopEvent.removeEventListener("mousedown",this._checkHideBind),this.stopEvent.parent.removeChild(this.stopEvent),this.stopEvent=null)}},{key:"show",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.btnTarget=e,this.exportRoot.visible=!0,this.exportRoot.parent.setChildIndex(this.exportRoot,this.exportRoot.parent.children.length-1),this.exportRoot.stage.addEventListener("stagemousedown",this._checkHideBind,!0)}},{key:"_checkHide",value:function(e){if(this.exportRoot.visible){var t=[this.btnTarget,this.exportRoot],n=!1;t.forEach((function(t){if(null!=t){var o=t.globalToLocal(e.stageX,e.stageY);!n&&1==t.hitTest(o.x,o.y)&&(n=!0)}})),n||(this.hide(),this.clickBtnNum(null))}}},{key:"_updatePosition",value:function(){if(null!=this.target){var e=this.target.exportRoot;e.getBounds(),this.exportRoot.x=e.x}}},{key:"clickBtnNum",value:function(e){"number"==typeof e&&(this.value=e);var t=this.selectedEvents||[];null!=t&&t.forEach((function(t){null!=t&&t(e)}))}}])&&Fe(t.prototype,n),o&&Fe(t,o),i}(ne);function We(e){return(We="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function $e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function Ze(e,t){return(Ze=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ge(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=ze(e);if(t){var r=ze(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return qe(this,n)}}function qe(e,t){if(t&&("object"===We(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function ze(e){return(ze=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Je=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ze(e,t)}(i,e);var t,n,o,r=Ge(i);function i(e,t){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),r.call(this,e,t)}return t=i,(n=[{key:"init",value:function(){this.exportRoot,this.reset()}},{key:"reset",value:function(){}},{key:"libCloneItem",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;try{var n=this.an.getComposition(this.anid).getLibrary(),o=new n[e];if(o.gotoAndStop(0),null!=t)for(var r in t)o[r]=t[r];return o}catch(e){}return null}}])&&$e(t.prototype,n),o&&$e(t,o),i}(G);function Qe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function et(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var tt=function(){function e(t,n){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;Qe(this,e),this.init(t,n,o)}var t,n,o;return t=e,(n=[{key:"destroy",value:function(){this.dragHandle&&this.dragHandle.removeAllEventListeners("mousedown"),this.handle=null,this.dragTarget=null,this.dragHandle=null,this.isDown=!1,this.isMove=!1,this.onStartEvent.length=0,this.onDragEvent.length=0,this.onEndEvent.length=0}},{key:"init",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return!0!==this.isInited&&(this.isInited=!0,this.handle=e,this.dragTarget=t,this.dragHandle=n||t,this.onStartEvent=[],this.onDragEvent=[],this.onEndEvent=[],this.onStartBind=this.onStart.bind(this),this.onDragBind=this.onDrag.bind(this),this.onEndBind=this.onEnd.bind(this),this.dragHandle&&this.dragHandle.addEventListener("mousedown",this.onStartBind),this.endPosX=0,this.endPosY=0,this.startPosX=0,this.startPosY=0,this.offsetX=0,this.offsetY=0,this.isDown=!1,this.isMove=!1,this.dragRect=null),this}},{key:"onStart",value:function(e){this.startPosX=e.stageX,this.startPosY=e.stageY,this.isDown=!0,this.isMove=!1;var t=this.dragTarget.localToGlobal(0,0);this.offsetX=t.x-e.stageX,this.offsetY=t.y-e.stageY;var n=this.dragHandle;n&&n.stage&&(n.stage.addEventListener("pressmove",this.onDragBind),n.stage.addEventListener("pressup",this.onEndBind)),this.onStartEvent.forEach((function(t){null!=t&&t(e)}))}},{key:"onDrag",value:function(e){if(!0===this.isDown){if(Math.abs(e.stageX-this.startPosX)<2&&Math.abs(e.stageY-this.startPosY)<2)return;this.isMove=!0,this.endPosX=e.stageX,this.endPosY=e.stageY;var t=this.dragRect,n=this.endPosX+this.offsetX,o=this.endPosY+this.offsetY;null!=t&&(n<t.x&&(n=t.x),o<t.y&&(o=t.y),n>t.x+t.width&&(n=t.x+t.width),o>t.y+t.height&&(o=t.y+t.height));var r=this.dragTarget.parent.globalToLocal(n,o);this.dragTarget.x=r.x,this.dragTarget.y=r.y,this.onDragEvent.forEach((function(t){null!=t&&t(e)}))}}},{key:"onEnd",value:function(e){this.onEndEvent.forEach((function(t){null!=t&&t(e)}));var t=this.dragHandle;t&&t.stage&&(t.stage.removeEventListener("pressmove",this.onDragBind),t.stage.removeEventListener("pressup",this.onEndBind)),this.isDown=!1,this.isMove=!1}}])&&et(t.prototype,n),o&&et(t,o),e}();function nt(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var ot=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,o;return t=e,(n=[{key:"init",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(this.colorIndex=0,this.colors=t,1==Array.isArray(e))this.numMCArr=e.slice(0);else{this.exportRoot=e;var n=this.exportRoot;n.gotoAndStop(0),this.numMCArr=[];for(var o=null==n?0:n.children.length,r=-1;o>=0;){o--,r++;var i=n.getChildByName("n_"+r);if(i){if(this.numMCArr.push(i),i.gotoAndStop(0),i.orgX=i.x,i.isShow=!0,null!=t){for(var a=[i],s=0;s<t.length;s++){var l=n.getChildByName(t[s]+r);null!=l&&(l.gotoAndStop(0),l.visible=!1,a.push(l))}i.colorIndex=0,i.colors=a}}else o=-1}}return this._numMax=parseInt(new Array(this.numMCArr.length).fill(9).join("")),this._valueMax=this._numMax,Object.defineProperty(this,"valueMax",{get:function(){return this._valueMax},set:function(e){e=e<0?0:this._numMax<e?this._numMax:e,this._valueMax!=e&&(this._valueMax=e,this._updateValue())}}),this._value=0,Object.defineProperty(this,"value",{get:function(){return this._value},set:function(e){this._setValue(e)}}),this._isVisible=!0,Object.defineProperty(this,"isVisible",{get:function(){return this._isVisible},set:function(e){this._isVisible=e,this._updateVisible(e)}}),this._isAlignCenter=!0,Object.defineProperty(this,"isAlignCenter",{get:function(){return this._isAlignCenter},set:function(e){this._isAlignCenter=e,this._updatePosition()}}),this._isShowHeadZero=!1,Object.defineProperty(this,"isShowHeadZero",{get:function(){return this._isShowHeadZero},set:function(e){this._isShowHeadZero=e,this._updatePosition()}}),this}},{key:"setColor",value:function(e){var t=this;this.colorIndex=e,(this.numMCArr||[]).forEach((function(e){var n=e.isShow;(e.colors||[]).forEach((function(o,r){o.x!=e.x&&(o.x=e.x),o.currentFrame!=e.currentFrame&&o.gotoAndStop(e.currentFrame),o.visible=n&&r==t.colorIndex}))}))}},{key:"_setValue",value:function(e){null!=e&&isNaN(parseInt(e))&&(e=null),this._value=this._valueMax<e?this._valueMax:e,this._updateValue()}},{key:"_updatePosition",value:function(){if(!0===this.isAlignCenter)for(var e,t=this.numMCArr,n=t.length,o=null,r=0,i=this._isShowHeadZero,a=n-1;0<=a;a--)e=t[a],null==o&&(o=e.orgX),!i&&(0!==e.currentFrame||0==a&&null!=this.value)&&(i=!0,r=e.orgX-o),e.x=e.orgX-r/2,e.visible=i,e.isShow=i;null!=this.colorIndex&&this.setColor(this.colorIndex)}},{key:"_updateValue",value:function(){for(var e,t,n=parseInt(this.value),o=this.numMCArr,r=o.length,i=0;i<r;i++)e=o[i],t=0<=n?Math.floor(n)%10:0,e.gotoAndStop(t),1<=n&&(n/=10);this._updatePosition()}},{key:"_updateVisible",value:function(e){for(var t=this.numMCArr,n=t.length,o=0;o<n;o++)t[o].visible=e;null!=this.exportRoot&&(this.exportRoot.visible=e),1==e&&this._updatePosition()}}])&&nt(t.prototype,n),o&&nt(t,o),e}();function rt(e){return(rt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function it(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function at(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function st(e,t,n){return t&&at(e.prototype,t),n&&at(e,n),e}function lt(e,t,n){return(lt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ft(e)););return e}(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function ut(e,t){return(ut=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ct(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=ft(e);if(t){var r=ft(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return ht(this,n)}}function ht(e,t){if(t&&("object"===rt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function ft(e){return(ft=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var dt=1280,pt=1080,vt=100,yt=320,gt=null,bt=null,mt=null,wt=null,xt=null,kt=null,St=null,Et=null,Ct=null,Pt=null,jt=null,_t=null,Ot=null,Tt=null,At=1,Rt=1,Bt=0,It=0,Mt=0,Dt=0,Nt=[],Lt=[],Ft=[],Ht=[],Vt=[],Xt=[],Yt=[],Ut=[],Kt=[],Wt=!0,$t=!1,Zt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ut(e,t)}(n,e);var t=ct(n);function n(e,o){return it(this,n),t.call(this,e,o)}return st(n,[{key:"reset",value:function(){this.settingInit()}},{key:"setVisible",value:function(e){lt(ft(n.prototype),"setVisible",this).call(this,e),this.init()}},{key:"init",value:function(){var e=this;if(!this.isInited){this.isInited=!0;var t=this.exportRoot;Xt.push(t.addChild(this.libCloneItem("mcArrow"))),Xt.push(t.addChild(this.libCloneItem("mcArrow"))),Xt.push(t.addChild(this.libCloneItem("mcArrow")));var n=new createjs.Shape;n.graphics.beginFill("#65BB65").drawRect(0,-5,1080.5,10).endFill(),n.setBounds(0,0,100,10),n.width=pt;var o=new createjs.Shape;o.graphics.beginFill("#B3A2C9").drawRect(-.5,-5,1080.5,10).endFill(),o.setBounds(0,0,100,10),o.width=pt,Ct=t.addChild(n),Pt=t.addChild(o),Nt=[null,Ct,Pt],0==Mt&&(Mt=Ct.getBounds().height),kt=t.addChild(this.libCloneItem("mcEndLine")),St=t.addChild(this.libCloneItem("mcEndLine")),Et=t.addChild(this.libCloneItem("mcEndLine")),Lt=[kt,St,Et],xt=t.addChild(this.libCloneItem("mcEndLineHot"));var r=new tt(this,xt);r.onDragEvent.push((function(t){e.dragMove(t)})),r.onEndEvent.push((function(t){e.dragEnd(t)})),r.onStartEvent.push((function(t){e.dragStart(t)})),xt.dragdropHandle=r,xt.cursor="pointer",Vt.push(new zt(t.addChild(new createjs.Shape))),Vt.push(new zt(t.addChild(new createjs.Shape))),Vt.push(new zt(t.addChild(new createjs.Shape))),Vt.push(new zt(t.addChild(new createjs.Shape))),Vt.push(new zt(t.addChild(new createjs.Shape))),Vt.push(new zt(t.addChild(new createjs.Shape))),Ft.length=0,Ft.push((new ot).init(t.addChild(this.libCloneItem("mcPlaceNum5")),["r_"])),Ft.push((new ot).init(t.addChild(this.libCloneItem("mcPlaceNum5")),["r_"])),Ft.push((new ot).init(t.addChild(this.libCloneItem("mcPlaceNum5")),["r_"])),Ht.length=0,Ft.forEach((function(t){var n=new qt(t);Ht.push(n),t.exportRoot.addEventListener("click",(function(t){e.inputSetFocus(n)}))})),(jt=this.handle.tipInputNum).y=yt,_t=this.handle.tipInputError,Ot=this.handle.tipInputNumMax,Tt=this.handle.tipDrag,(gt=this.handle.calcInstance).onEventOK=[function(){e.inputSetFocus(gt.getTarget(),!1)}],gt.onEventChange=[function(){bt.visible=e.inputCheck(null)}],(bt=this.handle.btnSetOK).addEventListener("click",(function(t){e.settingOK()})),(mt=this.handle.btnAnsZone).addEventListener("click",(function(t){e.toggleAnswer()})),(wt=this.handle.btnPrint).addEventListener("click",(function(t){e.imgExport()}))}this.settingUpdate(),this.settingInit()}},{key:"dragEnd",value:function(e){}},{key:"dragMove",value:function(e){xt.y=yt;var t=xt.x,n=parseInt((t-vt)/pt*Yt[0]);n<=0&&(n=1),n>=Yt[0]&&(n=Yt[0]-1),xt.x=vt+n/Yt[0]*pt,Yt[1]=n,Yt[2]=Yt[0]-n,Ut.forEach((function(e,t){isNaN(e)||e==Yt[t]||(Ut[t]=Yt[t])})),this.drawTextSpot(1==$t?Yt:Ut)}},{key:"dragStart",value:function(e){}},{key:"btnUpdate",value:function(){var e=1==Wt||-1==Kt.indexOf("blank");mt.disabled.visible=e,mt.mouseEnabled=!e;var t=1==$t?1:0;mt.currentFrame!=t&&mt.gotoAndStop(t),wt.disabled.visible=Wt,wt.mouseEnabled=!Wt}},{key:"drawTextSpot",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;null==e&&(e=[]),null==t&&(t=[]),1==Wt?(Ht.forEach((function(n,o){e.length<=o&&e.push(n.getValue()),t.length<=o&&t.push("edit")})),Ut=e):Ht.forEach((function(n,o){e.length<=o&&e.push(n.getValue()),t.length<=o&&t.push(isNaN(n.getValue())?"blank":"edit"==n.getStatus()?"":n.getStatus())})),Kt=t;var n=e.reduce((function(e,t){return isNaN(t)?e:e+1}),0);1==Wt&&(jt.visible=n<2);var o=[2,1,1];2<=n&&(isNaN(e[0])&&(o[0]=e[1]+e[2]),isNaN(e[1])&&(o[1]=e[0]-e[2]),isNaN(e[2])&&(o[2]=e[0]-e[1]),e.forEach((function(e,t){!isNaN(e)&&(o[t]=e)}))),Yt=o;var r=1,i=0;Ht.forEach((function(n,a){n.ans=o[a],n.setValue(e[a]),n.setStatus(t[a]);var s=n.ans;if(0==a)r=s,n.setTransform(640,It),n.length=pt;else{var l=i/r*pt+vt,u=s/r*pt;i+=s,Nt[a].x=l,Nt[a].scaleX=u/Nt[a].width,Lt[a].x=l+u,n.setTransform(l+.5*u,Bt),n.length=u}})),this.drawLineDashMark(),xt.setTransform(Lt[1].x,Lt[1].y)}},{key:"drawLineDashMark",value:function(){var e=It-yt,t=Bt-yt,n=[0,0,1,1,2,2],o=[1,1,1,1,2,2];Vt.forEach((function(r,i){var a,s,l,u,c,h,f=Nt[o[i]],d=Ht[n[i]],p=Xt[n[i]],v=Math.ceil(d.getWidth()),y=d.length<v?0:.45*(d.length-v);0<parseInt(y/24)?(l=i%2==0?(a=f.x)+y:(a=f.x+d.length)-y,s=f.y+(0==n[i]?1:-1)*Dt,c=a+(l-a)/4,h=u=f.y+(0==n[i]?e:t),r.drawClear().drawBezierCurve(l,u,c,h,a,s,3,"#666666"),p.visible&&(p.visible=!1)):(r.drawClear(),!p.visible&&(p.visible=!0),p.x=d.x,p.y=yt,p.rotation=Dt<0?180:0)}))}},{key:"imgDownload",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Default",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"png";n=n.toLowerCase();var o=t+"_"+Date.parse(new Date)+"."+n,r=document.createElement("a");r.style.display="none",r.href=e.toDataURL("image/jpeg"),r.download=o,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(r.href)}},{key:"imgExport",value:function(){var e=null,t=null,n=null,o=null,r=new createjs.Container,i=[this.exportRoot,this.handle.drawBoard.shapeContainer];i.forEach((function(r,i){var a=r.getBounds();null!=a&&((null==e||e>a.x)&&(e=a.x),(null==n||n<a.x+a.width)&&(n=a.x+a.width),(null==t||t>a.y)&&(t=a.y),(null==o||o<a.y+a.height)&&(o=a.y+a.height))})),n<1180&&(n=1180),e=Math.floor(e)-4,t=Math.floor(t)-4,n=Math.ceil(n)+4,o=Math.ceil(o)+4,e<0&&(e=0),t<0&&(t=0),n>dt&&(n=dt),o>720&&(o=720),i.forEach((function(i){i.cache(e,t,n-e,o-t),r.addChild(new createjs.Bitmap(i.cacheCanvas))})),r.width=n-e,r.height=o-t,i.forEach((function(e){e.uncache()}));var a=this.exportCan||document.getElementById("export_canvas");null==a&&((a=document.createElement("canvas")).id="export_canvas",this.exportCan=a);var s=this.exportSta;null==s&&(s=new createjs.Stage(a),this.exportSta=s);var l=null,u=null;try{var c=r;if(l=l||"線段圖",u=u||"jpg",a.width=c.width,a.height=c.height,s.removeAllChildren(),"png"!=u)s.addChild(new createjs.Shape).graphics.beginFill("#FFFFFF").drawRect(0,0,a.width,a.height).endFill();s.addChild(c),s.update(),this.imgDownload(a,l,u)}catch(e){}}},{key:"inputCheck",value:function(e){var t=!0,n=Ht[0].getValue(),o=Ht[1].getValue(),r=Ht[2].getValue();if(null==e){var i=0;return[o,r,n].forEach((function(e){isNaN(e)&&i++})),2<=i&&(t=!1),t&&1==i&&isNaN(n)&&o+r>1e4&&(t=!1),t&&1==i&&isNaN(o)&&(n>1e4||r>=n)&&(t=!1),t&&1==i&&isNaN(r)&&(n>1e4||o>=n)&&(t=!1),t}return(e==Ht[0]&&(n<Ht[0].minValue||n>Ht[0].maxValue)||e==Ht[1]&&(o<Ht[1].minValue||o>Ht[1].maxValue)||e==Ht[2]&&(r<Ht[2].minValue||r>Ht[2].maxValue))&&(t=!1),1==t&&(isNaN(o)||isNaN(r)||isNaN(n)?isNaN(n)||isNaN(o)?isNaN(n)||isNaN(r)?isNaN(o)||isNaN(r)||1e4<o+r&&(t=!1):e!=Ht[0]&&e!=Ht[2]||n<=r&&(t=!1):e!=Ht[0]&&e!=Ht[1]||n<=o&&(t=!1):e==Ht[0]?n!=o+r&&(t=!1):e==Ht[1]?o!=n-r&&(t=!1):e==Ht[2]&&r!=n-o&&(t=!1)),t}},{key:"inputFollowTarget",value:function(e){var t=e.exportRoot,n=t.getBounds(),o=gt.exportRoot.getBounds(),r=(n.width+o.width)/2,i=(o.height,dt-o.width-10),a=t.x+r,s=t.y;i<=a&&(a=t.x-r),gt.exportRoot.x=a,gt.exportRoot.y=s}},{key:"inputSetFocus",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(0==n){var o=e;return 0==this.inputCheck(o)?void this.tipShowTween(_t,(function(){gt.clear(),e.setValue(null),t.drawTextSpot(),t.inputFollowTarget(e)})):(gt.hide(),void this.drawTextSpot())}var r=gt.getTarget();if(null!=r){if(r==e)return;gt.setOK()}null!=e&&(this.inputFollowTarget(e),gt.setTarget(e),gt.show())}},{key:"settingInit",value:function(){Wt=!0,$t=!1,xt.visible=!1,Ht.forEach((function(e,t){0==t?(e.maxChars=5,e.minValue=2,e.maxValue=1e4):(e.maxChars=4,e.minValue=1,e.maxValue=9999),e.setColor(0)})),Tt.visible=!1,bt.visible=!1,jt.visible=!0,jt.gotoAndPlay(0),this.tipFlashTween(jt,(function(){jt.gotoAndStop(0)}),5e3),Ot.visible=!0,this.drawTextSpot([NaN,NaN,NaN],["edit","edit","edit"]),this.btnUpdate()}},{key:"settingCheck",value:function(){var e=[];return Ht.forEach((function(t,n){e.push(t.getValue())})),2<=e.reduce((function(e,t){return isNaN(t)?e:e+1}),0)}},{key:"settingOK",value:function(){if(!this.settingCheck())return gt.hide(),void this.tipShowTween(_t,(function(){}));Wt=!1,gt.hide(),bt.visible=!1,jt.gotoAndStop(0),jt.visible=!1,Ot.visible=!1,this.drawTextSpot(),this.btnUpdate(),xt.alpha=.01,xt.visible=!0,Tt.x=xt.x,Tt.y=xt.y,Tt.visible=!0,Tt.gotoAndPlay(0),this.tipShowTween(Tt,(function(){Tt.visible=!1}),3e3)}},{key:"settingUpdate",value:function(){Rt=T.lineLengthPosNum,1==(At=T.lineStyleNum)?(Lt.forEach((function(e){e.visible=!1,e.setTransform(vt,yt)})),Nt.forEach((function(e){null!=e&&e.setTransform(vt,yt)&&(e.scaleY=6)}))):2==At&&(Lt.forEach((function(e){e.visible=!0,e.setTransform(vt,yt)})),Nt.forEach((function(e){null!=e&&e.setTransform(vt,yt)&&(e.scaleY=1)}))),1==Rt?(Bt=220,It=420,Dt=Mt*Ct.scaleY/2):2==Rt&&(Bt=420,It=220,Dt=-Mt*Ct.scaleY/2)}},{key:"toggleAnswer",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;$t=null==e?!$t:e,Kt.forEach((function(e,t){"blank"==e&&(1==$t?Ht[t].setAnswer(Yt[t]):Ht[t].setValue(Ut[t]))})),this.btnUpdate()}},{key:"tipShowTween",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2e3;e.visible=!0,e.alpha=1,createjs.Tween.removeTweens(e);var o=createjs.Tween.get(e);return o.wait(n-300).to({alpha:0,visible:!1},300).call((function(){null!=t&&t()})),o}},{key:"tipFlashTween",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2e3;e.visible=!0,createjs.Tween.removeTweens(e);var o=createjs.Tween.get(e);return o.wait(n).call((function(){null!=t&&t()})),o}},{key:"update",value:function(){this.settingUpdate(),this.drawTextSpot(),this.toggleAnswer($t)}}]),n}(Je),Gt=0,qt=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;it(this,e),null!=t&&null!=t.exportRoot&&t.exportRoot.gotoAndStop(0),this.target=t,this.tag=++Gt,this.x=n,this.y=o,this.length=0,this.ans=null,this.value=null,this.status=null,this.maxChars=0,this.minValue=null,this.maxValue=null}return st(e,[{key:"exportRoot",get:function(){return null==this.target?null:this.target.exportRoot}},{key:"getValue",value:function(){return parseInt(this.value)}},{key:"getStatus",value:function(){return this.status}},{key:"getWidth",value:function(){var e=170,t=this.exportRoot;return null!=t&&!t.bg.visible&&(e=t.getBounds().width+20),e}},{key:"setAnswer",value:function(e){var t=this.target;null!=t&&(t.value=e,t.setColor(1))}},{key:"setColor",value:function(e){var t=this.target;null!=t&&t.setColor(e)}},{key:"setStatus",value:function(e){if(this.status!=e){this.status=e;var t=this.target;if(null!=t&&null!=t.exportRoot){var n=t.exportRoot;"edit"==e?(n.bg.gotoAndStop(0),n.bg.visible=!0,n.mouseEnabled=!0,n.cursor="pointer"):"blank"==e?(n.bg.gotoAndStop(1),n.bg.visible=!0,n.mouseEnabled=!1,n.cursor="auto"):(n.bg.visible=!1,n.mouseEnabled=!1,n.cursor="auto")}}}},{key:"setTransform",value:function(e,t){this.x=e,this.y=t;var n=this.target;null!=n&&n.exportRoot.setTransform(e,t)}},{key:"setValue",value:function(e){this.value=e;var t=this.target;null!=t&&(t.value=e)}}]),e}(),zt=function(){function e(t){it(this,e),this.shape=t||new createjs.Shape}return st(e,[{key:"drawClear",value:function(){return this.shape.graphics.clear(),this}},{key:"drawBezierCurve",value:function(e,t,n,o,r,i){var a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"#000000",l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:[13,11],u=arguments.length>9&&void 0!==arguments[9]?arguments[9]:0,c=this.shape.graphics;return c.setStrokeStyle(a).beginStroke(s),null!=l&&c.setStrokeDash(l,u),c.bezierCurveTo(e,t,n,o,r,i),this}}]),e}();function Jt(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Qt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Qt(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var o=0,r=function(){};return{s:r,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function Qt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function en(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var tn,nn,on,rn,an,sn=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),T.appMain=this}var t,n,o;return t=e,(n=[{key:"init",value:function(e,t,n,o){T.cjs=e,T.an=t,T.exportRoot=n,T.anid=o,this.cjs=e,this.an=t,this.exportRoot=n,this.anid=o,this.isInited=!1,n&&(n.gotoAndStop(0),this.onAddedToStageBind=this.onAddedToStage.bind(this),null==n.stage?n.addEventListener("added",this.onAddedToStageBind):this.onAddedToStage(null))}},{key:"onAddedToStage",value:function(e){var t=this;if(!this.isInited){this.isInited=!0,this.toolbar=null,this.drawBoard=null,this.game=null,this.drawBoard=new M(this.cjs,this.an,this.exportRoot.getChildByName("draw_container"),this.anid),T.drawBoard=this.drawBoard;var n={drawWidth:1280,drawHeight:612,cursor:this.exportRoot.getChildByName("cursor_mc")};this.drawBoard.init(n);var o,r=Jt(this.exportRoot.children);try{for(r.s();!(o=r.n()).done;){var i=o.value;if(null!=i.name){"pencolor_panel"==i.name&&(this.penColorPannel=new V(this,i),this.penColorPannel.onSelectedEvent.push((function(e){T.penColorIndex=t.penColorPannel.selectedIndex,t.drawBoard.setLineColor(O[T.penColorIndex])}))),"numinput_panel"==i.name?(i.visible=!1,this.calcInstance=new Ae(this,i),this.calcInstance.setDragTarget(i.getChildByName("bg")),this.calcInstance.maxChars=1):"numpos_panel"==i.name?function(){i.visible=!1;var e=t.lineLengthPosPanel=new Ke(t,i);e.selectedEvents.push((function(n){null!=n&&(T.lineLengthPosNum=parseInt(e.value),t.lineLengthPosDropBtn.title.gotoAndStop(T.lineLengthPosNum-1),t.game.update()),t.setLineLengthPosPanelShow(!1)}))}():"style_panel"==i.name&&function(){i.visible=!1;var e=t.lineStylePanel=new Ke(t,i);e.selectedEvents.push((function(n){null!=n&&(T.lineStyleNum=parseInt(e.value),t.lineStyleDropBtn.title.gotoAndStop(T.lineStyleNum-1),t.game.update()),t.setLineStylePanelShow(!1)}))}();var a=i.name.split("_");"btn"==a[0]?(i.value=a[1],i.gotoAndStop(0),i.removeAllEventListeners("click"),i.mouseChildren=!1,i.cursor="pointer","AnsZone"==a[1]?(this.btnAnsZone=i,i.addEventListener("click",(function(e){t.onClick(e)}))):"setok"==a[1]?(i.visible=!1,this.btnSetOK=i,i.addEventListener("click",(function(e){t.onClick(e)}))):"print"==a[1]&&(this.btnPrint=i)):"dropbtn"==a[0]?(i.gotoAndStop(0),i.title=i.getChildByName("icon"),null!=i.title&&i.title.gotoAndStop(0),i.removeAllEventListeners("mousedown"),i.mouseChildren=!1,i.cursor="pointer","style"==a[1]?(this.lineStyleDropBtn=i,i.addEventListener("mousedown",(function(e){t.setLineStylePanelShow(0==t.lineStyleDropBtn.currentFrame)}))):"numpos"==a[1]&&(this.lineLengthPosDropBtn=i,i.addEventListener("mousedown",(function(e){t.setLineLengthPosPanelShow(0==t.lineLengthPosDropBtn.currentFrame)})))):"tip"==a[0]&&(i.gotoAndStop(0),i.visible=!1,"inputnum"==a[1]?this.tipInputNum=i:"inputerror"==a[1]?this.tipInputError=i:"nummax"==a[1]?this.tipInputNumMax=i:"drag"==a[1]&&(this.tipDrag=i))}}}catch(e){r.e(e)}finally{r.f()}this.getSceneById(0),this.toolbar=new Me(this,this.exportRoot)}var s=T.getHtmlParams(location.search).id;""<s&&(100<(s=parseInt(s))?(T.theme=parseInt(s/100),T.type=s%100):10<s?(T.theme=parseInt(s/10),T.type=s%10):(T.theme=s,T.type=0)),this.setSceneById(T.theme)}},{key:"getSceneById",value:function(e){this.sceneAll=this.sceneAll||{};var t=this.sceneAll[e];if(null==t){var n,o=this.exportRoot;switch(e){case 1:n=o.getChildByName("clone_container"),t=new Zt(this,n),null==n&&o.addChildAt(t,1)}this.sceneAll[e]=t}return t}},{key:"goBack",value:function(){1<T.sceneHistory.length&&T.sceneHistory.pop();var e=0==T.sceneHistory.length?null:T.sceneHistory.pop();null!=e&&this.setSceneById(e)}},{key:"onClick",value:function(e){e.currentTarget.value}},{key:"reset",value:function(){this.calcInstance.hide();var e=this.game;null!=e&&null!=e.reset&&e.reset()}},{key:"selectMenuMain",value:function(e){null!=e&&(T.theme=e+1),this.setSceneById(T.theme)}},{key:"setLineLengthPosPanelShow",value:function(e){var t=this.lineLengthPosDropBtn;null!=t&&t.gotoAndStop(e?1:0);var n=this.lineLengthPosPanel;null!=n&&(e?n.show(t):n.hide())}},{key:"setLineStylePanelShow",value:function(e){var t=this.lineStyleDropBtn;null!=t&&t.gotoAndStop(e?1:0);var n=this.lineStylePanel;null!=n&&(e?n.show(t):n.hide())}},{key:"setPenColorPanelShow",value:function(e){var t=this.penColorPannel;1==e&&null!=t&&t.selectedIndex!=T.penColorIndex&&(t.selectedIndex=T.penColorIndex),null!=t&&(e?t.show():t.hide())}},{key:"setSceneById",value:function(e){T.type<1&&(T.type=1),this.setPenColorPanelShow(!1),this.setLineLengthPosPanelShow(!1),this.setLineStylePanelShow(!1),this.toolbar.reset();var t=this.sceneAll||{},n=null;for(var o in t)o!==e&&null!=(n=t[o])&&null!=n.setVisible&&n.setVisible(!1);null!=(n=this.getSceneById(e))&&(T.sceneHistory.push(e),null!=n.setVisible&&n.setVisible(!0),this.game=0<e?n:null)}}])&&en(t.prototype,n),o&&en(t,o),e}());tn=!(!window.attachEvent||window.opera),nn=/webkit\/(\d+)/i.test(navigator.userAgent)&&RegExp.$1<525,on=[],rn=function(){for(var e=0;e<on.length;e++)on[e]()},(an=document).ready=function(e){if(!tn&&!nn&&an.addEventListener)return an.addEventListener("DOMContentLoaded",e,!1);if(!(on.push(e)>1))if(tn)!function(){try{an.documentElement.doScroll("left"),rn()}catch(e){setTimeout(arguments.callee,0)}}();else if(nn)var t=setInterval((function(){/^(loaded|complete)$/.test(an.readyState)&&(clearInterval(t),rn())}),0)},document.ready((function(){document.body.setAttribute("onload",""),document.oncontextmenu=function(e){return!1},window.onload=function(){init((function(e,t){sn.init(createjs,AdobeAn,e,t.properties.id)}))}}))}]);